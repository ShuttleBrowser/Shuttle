<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Shuttle</title>

    <script src="./assets/js/vex.combined.min.js"></script>
    <script>vex.defaultOptions.className = 'vex-theme-default'</script>
    <link rel="stylesheet" href="./assets/css/vex.css"/>
    <link rel="stylesheet" href="./assets/css/vex-theme-default.css"/>

  </head>

  <div id="app"></div>

  <script src="./assets/js/all.js"></script>
  <script>
    window.require = require

    const { loadFile, event, bookmarks, view, files, auth, settings, controlBar, modales, store, sync } = require('./modules/index.js')
    const { ipcRenderer } = require('electron')
    const lang = require('../lang/lang.js')

    window.alert = (message) => {
      modales.alert(message)
    }

    const shuttle = {
      initApp () {
        if (files.settings.getValue('settings.firstRun') === undefined) {
          if (!files.settings.getValue('settings.isLogged')) {
            shuttle.showAuth()
          }
          files.settings.setValue('settings.firstRun', false)
        } else {
          shuttle.showBrowser()
        }
      },

      showBrowser () {
        loadFile('browser').then(() => {
          bookmarks.loadBookmarks().then(() => {
            view.load()
            loadFile('settings', '.settings').then(() => {
              settings.setLang()
              settings.setCheckBox()
              settings.setAccountBtn()
            })
            loadFile('appStore', '.store').then(() => {
              store.runListener()
            })
          })
        })
      },

      showAuth () {
        loadFile('auth')
      },
    }

    shuttle.initApp()
    ipcRenderer.on('OPEN_SETTINGS', (event, data) => {
      EventsEmitter.emit('SHOW_SETTINGS')
    })

    EventsEmitter.on('SHOW_BROWSER', () => {
      shuttle.showBrowser()
    })

    EventsEmitter.on('SHOW_AUTH', () => {
      shuttle.showAuth()
    })
  </script>

  <style>
    @font-face {
      font-family: SourceSansPro-Light;
      src: url(./assets/fonts/SourceSansPro-Light.ttf);
    }

    @font-face {
      font-family: SourceSansPro-Regular;
      src: url(./assets/fonts/SourceSansPro-Regular.ttf);
    }

    @font-face {
      font-family: SourceSansPro-SemiBold;
      src: url(./assets/fonts/SourceSansPro-SemiBold.ttf);
    }

    body {
      font-family: SourceSansPro-Regular;
    }
  </style>

</html>